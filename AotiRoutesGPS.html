<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<style type="text/css">
			body,
			html,
			#allmap {
				width: 100%;
				height: 100%;
				overflow: hidden;
				margin: 0;
			}
		</style>
		<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=U1YCvtrqNiTGdD3p8quHqHKKGpVw2cxH"></script>
		<script src="FileSaver.js"></script>
		<title>单击获取点击位置的经纬度并绘制折线轨迹</title>
	</head>

	<body>
		<input id='txt' type="text" value="当前已生成的路径数目：0" style="width: 200px; height: 35px;" disabled="disabled" />
		<button id="btnGenerateRoute" style="height: 35px;">Generate Route</button>
		<button id="btnGenerateGPS" style="height: 35px;">Save Routes</button>
		&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
		<label id="currentState">当前状态：准备开始绘制路径！</label>
		<div id="allmap"></div>
	</body>

</html>
<script type="text/javascript">
	//全局变量设置
	var routes = []; //所有线路的坐标点，元素为route
	var route = []; //一条线路的所有坐标点，元素为数组
	var route_1 = []; //一条线路的所有坐标点，元素为单个数值
	var polylines = [];
	var polyline = [];

	//地图初始化
	var map = new BMap.Map("allmap"); // 创建Map实例
	map.centerAndZoom(new BMap.Point(106.512408, 29.531104), 17); //初始化地图,以重庆市九龙坡区奥体匹克体育中心为中心，缩放级别为17
	map.enableScrollWheelZoom(); //启用滚轮放大缩小，默认禁用
	map.enableContinuousZoom(); //启用地图惯性拖拽，默认禁用

	//鼠标点击地图获取坐标、添加（删除）覆盖物，添加覆盖物的点击事件
	map.addEventListener("click", function(e) {
		document.getElementById("currentState").innerHTML = '当前状态：' + '正在生成路径！';
		document.getElementById("currentState").style.color = 'red';
		//map.removeOverlay(overlay: Overlay) - 从地图中移除覆盖物。如果覆盖物从未被添加到地图中，则该移除不起任何作用
		//map.clearOverlays() - 清除地图上所有覆盖物
		route.push([e.point.lng, e.point.lat]);
		route_1.push(e.point.lng); //经度
		route_1.push(e.point.lat); //纬度
		map.clearOverlays(); //清除地图上所有的
